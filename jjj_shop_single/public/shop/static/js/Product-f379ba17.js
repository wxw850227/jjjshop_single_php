import{E as e,q as a,r as l,e as t,f as i,d as o,c as s,l as n,m as d,n as r,o as c,v as u}from"./element-plus-68e4b1c7.js";import{P as h}from"./product-a5c451ce.js";import{_ as p}from"./index-d5abae2c.js";import{o as g,T as m,S as f,a as b,P as C,W as y,Y as _,c as k,Q as S,a9 as v,$ as z}from"./@vue-76da2f05.js";const V={class:"common-seach-wrap"},w={class:"product-content"},x={class:"table-wrap"},I=["src"],D={class:"pagination"},L={class:"dialog-footer"};const P=p({data:()=>({loading:!0,curPage:1,pageSize:20,totalDataNumber:0,formInline:{},cateList:[],productList:[],status:[{id:10,name:"上架"},{id:20,name:"下架"}],multipleSelection:[],formLabelWidth:"120px",dialogVisible:!1,type:"error",params:null}),props:["isproduct","excludeIds","islist"],watch:{isproduct:function(e,a){e!=a&&e&&(this.dialogVisible=e,this.type="error",this.params=null,this.getData())}},created(){},methods:{selectableFunc:e=>"boolean"!=typeof e.noChoose||e.noChoose,handleCurrentChange(e){this.curPage=e,this.getData()},handleSizeChange(e){this.curPage=1,this.pageSize=e,this.getData()},getData(){let e=this,a=e.formInline;a.page=e.curPage,a.list_rows=e.pageSize,h.chooseLists(a,!0).then((a=>{1==a.code&&(e.loading=!1,e.cateList=a.data.category,e.excludeIds&&void 0!==e.excludeIds&&e.excludeIds.length>0?a.data.list.data.forEach((a=>{e.excludeIds.indexOf(a.product_id)>-1?a.noChoose=!1:a.noChoose=!0})):e.islist||a.data.list.data.forEach((e=>{e.noChoose=!0})),e.productList=a.data.list.data,e.totalDataNumber=a.data.list.total)})).catch((e=>{}))},SingleFunc(e){this.multipleSelection=[e],this.addClerk()},addClerk(){let a=this,l=null;a.multipleSelection.length<1?e({message:"请至少选择一件产品商品！",type:"error"}):(a.islist&&void 0!==a.islist?(a.multipleSelection.forEach((e=>{e.image=e.image[0].file_path})),l=a.multipleSelection):(l=a.multipleSelection[0],l.image=l.image[0].file_path),a.params=l,a.type="success",a.dialogVisible=!1)},dialogFormVisible(){this.$emit("closeDialog",{type:this.type,openDialog:!1,params:this.params})},tableCurrentChange(e){this.multipleSelection=e}}},[["render",function(e,h,p,P,F,j){const E=a,N=l,U=t,W=i,$=o,q=s,M=n,O=d,Q=r,T=c,Y=u;return g(),m(T,{title:"选择商品",modelValue:F.dialogVisible,"onUpdate:modelValue":h[3]||(h[3]=e=>F.dialogVisible=e),onClose:j.dialogFormVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"900px"},{footer:f((()=>[b("div",L,[C(W,{size:"small",onClick:h[2]||(h[2]=e=>F.dialogVisible=!1)},{default:f((()=>[y("取 消")])),_:1}),p.islist?(g(),m(W,{key:0,size:"small",type:"primary",onClick:j.addClerk},{default:f((()=>[y("确 定")])),_:1},8,["onClick"])):_("",!0)])])),default:f((()=>[b("div",V,[C(q,{inline:!0,size:"small",model:F.formInline,class:"demo-form-inline"},{default:f((()=>[C(U,{label:"商品分类"},{default:f((()=>[C(N,{modelValue:F.formInline.category_id,"onUpdate:modelValue":h[0]||(h[0]=e=>F.formInline.category_id=e),placeholder:"请选择商品分类"},{default:f((()=>[(g(!0),k(S,null,v(F.cateList,(e=>(g(),k(S,{key:e.category_id},[C(E,{value:0,label:"全部"}),C(E,{value:e.category_id,label:e.name},null,8,["value","label"]),e.child&&e.child.length>0?(g(!0),k(S,{key:0},v(e.child,(e=>(g(),k(S,{key:e.category_id},[C(E,{value:e.category_id,label:e.name,style:{"padding-left":"30px"}},null,8,["value","label"]),e.child&&e.child.length>0?(g(!0),k(S,{key:0},v(e.child,(e=>(g(),m(E,{key:e.category_id,value:e.category_id,label:e.name,style:{"padding-left":"60px"}},null,8,["value","label"])))),128)):_("",!0)],64)))),128)):_("",!0)],64)))),128))])),_:1},8,["modelValue"])])),_:1}),C(U,{label:"商品名称"},{default:f((()=>[C($,{placeholder:"请输入商品名称",modelValue:F.formInline.search,"onUpdate:modelValue":h[1]||(h[1]=e=>F.formInline.search=e)},{append:f((()=>[C(W,{icon:"Search",onClick:j.getData},{default:f((()=>[y("查询")])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])]),b("div",w,[b("div",x,[z((g(),m(O,{size:"small",data:F.productList,border:"",style:{width:"100%"},"highlight-current-row":"",onSelectionChange:j.tableCurrentChange},{default:f((()=>[C(M,{width:"70",label:"商品图片"},{default:f((({row:e})=>[b("img",{src:e.image&&e.image[0].file_path,width:"30",height:"30"},null,8,I)])),_:1}),C(M,{prop:"product_name",label:"商品名称"}),C(M,{prop:"category.name",width:"100",label:"商品分类"}),C(M,{prop:"create_time",width:"140",label:"添加时间"}),p.islist?(g(),m(M,{key:0,type:"selection",selectable:j.selectableFunc,width:"44"},null,8,["selectable"])):_("",!0),p.islist?_("",!0):(g(),m(M,{key:1,width:"80",label:"单选"},{default:f((({row:e})=>[e.noChoose?(g(),m(W,{key:0,size:"small",onClick:a=>j.SingleFunc(e)},{default:f((()=>[y("选择")])),_:2},1032,["onClick"])):(g(),m(W,{key:1,size:"small",disabled:""},{default:f((()=>[y("已选")])),_:1}))])),_:1}))])),_:1},8,["data","onSelectionChange"])),[[Y,F.loading]])]),b("div",D,[C(Q,{onSizeChange:j.handleSizeChange,onCurrentChange:j.handleCurrentChange,background:"","current-page":F.curPage,"page-sizes":[2,10,20,50,100],"page-size":F.pageSize,layout:"total, prev, pager, next, jumper",total:F.totalDataNumber},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])])])),_:1},8,["modelValue","onClose"])}]]);export{P as _};
