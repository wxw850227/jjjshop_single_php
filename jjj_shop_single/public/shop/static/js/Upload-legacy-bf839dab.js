System.register(["./AddCategory-legacy-6a8e16df.js","./element-plus-legacy-cd39421e.js","./file-legacy-0bc78948.js","./@vue-legacy-3fcc10b7.js","./Upload.vue_vue_type_style_index_0_scoped_e92f80dd_lang-legacy-00f7475a.js","./index-legacy-4f532ec6.js"],(function(e,t){"use strict";var i,n,a,o,c,l,r,s,u,f,g,d,p,h,y,_,m,C,v,k,F,b,w,z,S,x,L;return{setters:[function(e){i=e._},function(e){n=e.a,a=e.E,o=e.s,c=e.f,l=e.A,r=e.t,s=e.B,u=e.n,f=e.o},function(e){g=e.F},function(e){d=e.ae,p=e.o,h=e.c,y=e.P,_=e.S,m=e.W,C=e.a,v=e.Q,k=e.a9,F=e.X,b=e.M,w=e.a1,z=e.Y,S=e.V,x=e.T},null,function(e){L=e._}],execute:function(){var t={class:"upload-wrap"},T={class:"upload-wrap-inline mb16 clearfix"},D={class:"leval-item"},j={class:"move-type"},I=["onClick"],B={class:"leval-item upload-btn"},P={class:"fileContainer"},U={class:"file-type"},V=["onClick"],E=["onClick"],N=["onClick"],A={class:"file-content"},W={class:"fileContainerUI clearfix"},q=["onClick"],O={key:0,class:"selectedIcon"},$={class:"iconBox"},M=["scr"],Q=["src"],X={class:"desc"},Y=["onClick"],G={class:"pagination-wrap"};e("_",L({components:{AddCategory:i},data:function(){return{dialogWidth:"910px",activeType:null,typeList:[],imageUrl:null,dialogVisible:!0,fileList:[],addLoading:!1,this_config:{total:1,file_type:"image"},record:0,loading:!0,tableData:[],pageSize:36,totalDataNumber:0,curPage:1,isShowCategory:!1,category:null,fileIds:[],accept:""}},props:["config"],created:function(){if("[object object]"===Object.prototype.toString.call(this.config).toLowerCase()){for(var e in this.config)this.this_config[e]=this.config[e];"image"==this.this_config.file_type?this.accept="image/jpeg,image/png,image/jpg":this.accept="video/mp4"}this.getFileCategory(),this.getData()},methods:{getFileCategory:function(){var e=this;g.fileCategory({type:e.this_config.file_type},!0).then((function(t){e.typeList=[{group_id:null,group_name:"全部"}].concat(t.data.group_list)})).catch((function(t){e.loading=!1}))},addCategory:function(){this.isShowCategory=!0},editCategoryFunc:function(e){this.isShowCategory=!0,this.category=e},closeCategoryFunc:function(e){null!=e&&this.getFileCategory(),this.isShowCategory=!1},deleteCategoryFunc:function(e){var t=this;n.confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteCategory(e)})).catch((function(){a({type:"info",message:"已取消删除"})}))},deleteCategory:function(e){var t=this;g.deleteCategory({group_id:e}).then((function(e){a({message:"删除成功",type:"success"}),t.getFileCategory()})).catch((function(e){a.error("删除失败")}))},selectTypeFunc:function(e){this.activeType=e,this.curPage=1,this.getData()},handleCurrentChange:function(e){this.curPage=e,this.getData()},handleSizeChange:function(e){this.curPage=1,this.pageSize=e,this.getData()},getData:function(){var e=this,t={page:e.curPage,pageSize:e.pageSize,group_id:e.activeType,type:e.this_config.file_type};g.fileList(t,!0).then((function(t){e.loading=!1,e.fileList=t.data.file_list,e.totalDataNumber=e.fileList.total})).catch((function(t){e.loading=!1}))},moveTypeFunc:function(e){var t=this,i=[];t.fileList.data.forEach((function(e){e.selected&&i.push(e.file_id)})),0!=i.length?n.confirm("确定移动选中的文件吗, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){g.moveFile({group_id:e,fileIds:i},!0).then((function(e){a({message:"移动成功",type:"success"}),t.getFileCategory(),t.getData()})).catch((function(e){}))})).catch((function(){})):a({message:"请选择文件",type:"warning"})},fileChange:function(e){},onBeforeUploadImage:function(e){return!0},UploadImage:function(e){var t=this,i=o.service({lock:!0,text:"图片上传中,请等待",background:"rgba(0, 0, 0, 0.7)"}),n=new FormData;n.append("iFile",e.file),n.append("group_id",t.activeType),n.append("file_type",t.this_config.file_type),g.uploadFile(n).then((function(n){i.close(),t.getData(),e.onSuccess()})).catch((function(t){i.close(),a({message:"本次上传图片失败",type:"warning"}),e.onError()}))},selectFileFunc:function(e,t){if(e.selected)e.selected=!1,this.record--;else{if(e.selected=!0,this.record++,this.record>=this.this_config.total)return void a({message:"本次最多只能上传 "+this.this_config.total+" 个文件",type:"warning"});e.selected=!0,this.record++}},deleteFileFunc:function(e){var t=this;n.confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=o.service({lock:!0,text:"图片上传中,请等待",background:"rgba(0, 0, 0, 0.7)"}),n=[];if(e)n.push(e.file_id);else for(var c=0;c<t.fileList.data.length;c++){var l=t.fileList.data[c];l.selected&&n.push(l.file_id)}g.deleteFiles({fileIds:n},!0).then((function(e){i.close(),a({message:"删除成功",type:"success"}),t.getData()})).catch((function(e){i.close()}))})).catch((function(){loading.close(),a({message:"删除失败",type:"warning"})}))},confirmFunc:function(){for(var e=[],t=0,i=0;i<this.fileList.data.length;i++){var n=this.fileList.data[i];if(n.selected){var a={file_id:n.file_id,file_path:n.file_path};e.push(a),t++}if(t>this.this_config.total)break}this.$emit("returnImgs",e)},cancelFunc:function(){this.$emit("returnImgs",null)}}},[["render",function(e,n,a,o,g,L){var H=c,J=l,K=r,R=d("Edit"),Z=s,ee=d("Delete"),te=d("Select"),ie=u,ne=f,ae=i;return p(),h("div",t,[y(ne,{title:"文件管理",modelValue:g.dialogVisible,"onUpdate:modelValue":n[3]||(n[3]=function(e){return g.dialogVisible=e}),"close-on-click-modal":!1,"custom-class":"upload-dialog","close-on-press-escape":!1,onClose:L.cancelFunc,width:g.dialogWidth,"append-to-body":!0},{footer:_((function(){return[y(H,{size:"small",onClick:L.cancelFunc},{default:_((function(){return[m("取 消")]})),_:1},8,["onClick"]),y(H,{size:"small",type:"primary",onClick:L.confirmFunc},{default:_((function(){return[m("确 定")]})),_:1},8,["onClick"])]})),default:_((function(){return[C("div",T,[C("div",D,[y(H,{size:"small",icon:"Plus",onClick:L.addCategory},{default:_((function(){return[m("添加分类")]})),_:1},8,["onClick"]),y(J,{placement:"bottom",width:"200",trigger:"click",value:!0},{reference:_((function(){return[y(H,{size:"small",icon:"CaretBottom"},{default:_((function(){return[m("移动至")]})),_:1})]})),default:_((function(){return[C("ul",j,[(p(!0),h(v,null,k(g.typeList,(function(e,t){return p(),h("li",{key:t,onClick:function(t){return L.moveTypeFunc(e.group_id)}},F(e.group_name),9,I)})),128))])]})),_:1}),y(H,{size:"small",type:"danger",icon:"Delete",onClick:n[0]||(n[0]=function(e){return L.deleteFileFunc(!1)})},{default:_((function(){return[m("批量删除")]})),_:1})]),C("div",B,[y(K,{class:"avatar-uploader",multiple:"",ref:"upload",action:"string",accept:g.accept,"before-upload":L.onBeforeUploadImage,"http-request":L.UploadImage,"show-file-list":!1,"on-change":L.fileChange},{default:_((function(){return[y(H,{size:"small",icon:"Upload",type:"primary"},{default:_((function(){return[m("点击上传")]})),_:1})]})),_:1},8,["accept","before-upload","http-request","on-change"])])]),C("div",P,[C("div",U,[C("ul",null,[(p(!0),h(v,null,k(g.typeList,(function(e,t){return p(),h("li",{class:b(g.activeType==e.group_id?"item active":"item"),key:t,onClick:function(t){return L.selectTypeFunc(e.group_id)}},[m(F(e.group_name)+" ",1),null!=e.group_id?(p(),h("div",{key:0,class:"operation",onClick:n[1]||(n[1]=w((function(){}),["stop"]))},[C("p",{onClick:function(t){return L.editCategoryFunc(e)}},[y(Z,null,{default:_((function(){return[y(R)]})),_:1})],8,E),C("p",{onClick:function(t){return L.deleteCategoryFunc(e.group_id)}},[y(Z,null,{default:_((function(){return[y(ee)]})),_:1})],8,N)])):z("",!0)],10,V)})),128))])]),C("div",A,[C("ul",W,[(p(!0),h(v,null,k(g.fileList.data,(function(e,t){return p(),h("li",{class:"file",key:t,onClick:function(i){return L.selectFileFunc(e,t)}},[1==e.selected?(p(),h("div",O,[C("div",$,[y(Z,null,{default:_((function(){return[y(te)]})),_:1})])])):z("",!0),"image"==g.this_config.file_type?(p(),h("img",{key:1,scr:e.file_path,style:S("background-image:url("+e.file_path+")"),alt:""},null,12,M)):z("",!0),"video"==g.this_config.file_type?(p(),h("video",{key:2,height:"100",width:"100",src:e.file_path,autoplay:!1}," 您的浏览器不支持 video 标签 ",8,Q)):z("",!0),C("p",X,F(e.real_name),1),C("div",{class:"bottom-shade",onClick:n[2]||(n[2]=w((function(){}),["stop"]))},[C("a",{href:"javascript:void(0)",onClick:function(t){return L.deleteFileFunc(e)}},[y(Z,null,{default:_((function(){return[y(ee)]})),_:1})],8,Y)])],8,q)})),128))])])]),C("div",G,[y(ie,{onSizeChange:L.handleSizeChange,onCurrentChange:L.handleCurrentChange,"current-page":g.curPage,"page-sizes":[12,24,36,42,48],"page-size":g.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:g.totalDataNumber},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])]})),_:1},8,["modelValue","onClose","width"]),g.isShowCategory?(p(),x(ae,{key:0,category:g.category,file_type:g.this_config.file_type,onCloseCategory:L.closeCategoryFunc},null,8,["category","file_type","onCloseCategory"])):z("",!0)])}],["__scopeId","data-v-e92f80dd"]]))}}}));
