import{_ as t,R as e,y as a,A as s,a as n,o as l,c as i,w as d,n as o,e as u,g as r,b as c,d as h,t as g,u as y,f,r as _,F as m,i as p,j as k}from"./index-024cd044.js";const w=t({data:()=>({loading:!0,weeklist:["日","一","二","三","四","五","六"],daylist:[],year:null,today_year:null,month:null,today_month:null,day:null,today_day:null,list:[],reward:[],days:0,today:0,is_sign:!1,point:[],rule:""}),mounted(){this.init()},onShow(){this.getData(),this.getRule()},methods:{getRule(){let t=this;t._get("plus.sign.sign/getSign",{},(function(a){a.data.detail=e.format_content(a.data.detail),t.rule=a.data.detail}))},getData(){let t=this;a({title:"加载中"}),t._get("plus.sign.sign/index",{},(function(e){t.list=e.data.list[0],t.days=e.data.list[1],t.today=e.data.list[2],t.reward=e.data.arr,t.point=e.data.point,t.list.indexOf(t.day)>=0&&(t.is_sign=!0),t.loading=!1,s()}))},onSign(){let t=this;if(t.is_sign)return n({title:"今天已签到",duration:2e3}),!1;a({title:"正在提交",mask:!0}),t._get("plus.sign.sign/add",{},(function(e){s(),t.showSuccess(e.data.msg,(function(){t.getData()}))}))},init(){if(null===this.year&&null===this.month&&null===this.day){let t=new Date;this.year=t.getFullYear(),this.today_year=t.getFullYear(),this.month=t.getMonth(),this.today_month=t.getMonth()+1,this.day=t.getDate(),this.today_day=t.getDate()}this.joinDay()},joinDay(){let t=[],e=this.getMonthCount(this.year,this.month),a=this.getPreMonthCount(this.year,this.month),s=this.getNextMonthCount(this.year,this.month),n=this.getWeekday(this.year,this.month),l=[];0!=n&&(l=a.slice(-1*n));let i=s.slice(0,42-e.length-n),d=this.numConvertNode(l,"pre"),o=this.numConvertNode(e,null),u=this.numConvertNode(i,"next");t=[].concat(d,o,u),this.daylist=t},numConvertNode(t,e){let a=0,s=[],n=t.length;null!=e&&("pre"==e?a=-1:(a=1,n>7&&(n-=7)));for(let l=0;l<n;l++){let e={type:a,day:t[l]};s.push(e)}return s},isLeapYear:t=>t%400==0||t%100!=0&&t%4==0,getMonthCount(t,e){let a=[31,null,31,30,31,30,31,31,30,31,30,31][e]||(this.isLeapYear(t)?29:28);return Array.from(new Array(a),((t,e)=>e+1))},getWeekday:(t,e)=>new Date(t,e,1).getDay(),getPreMonthCount(t,e){return 0===e?this.getMonthCount(t-1,11):this.getMonthCount(t,e-1)},getNextMonthCount(t,e){return 11===e?this.getMonthCount(t+1,0):this.getMonthCount(t,e+1)},gotoRuleFunc(){this.gotoPage("/pages/plus/signin/rule/rule")}}},[["render",function(t,e,a,s,n,w){const x=p,C=k,M=r;return n.loading?u("",!0):(l(),i(M,{key:0,"data-theme":t.theme(),class:o([t.theme()||"","signin-container"])},{default:d((()=>[c(M,{class:"pr signin-top"},{default:d((()=>[c(x,{class:"bg-signin",src:"/h5/assets/signin-c2297138.png",mode:""}),c(M,{class:"d-b-c top-box"},{default:d((()=>[n.reward.length>0&&n.reward[0]>=1?(l(),i(M,{key:0},{default:d((()=>[h(" 签到"),c(C,{class:"p-0-10 text2 fb"},{default:d((()=>[h(g(n.reward[0]),1)])),_:1}),h(" 天可额外得到"),c(C,{class:"p-0-10 text2 fb"},{default:d((()=>[h(g(n.point[n.reward[0]]),1)])),_:1}),h(g(t.points_name()),1)])),_:1})):u("",!0),n.reward.length>0&&1==n.reward[0]&&!n.is_sign?(l(),i(M,{key:1},{default:d((()=>[h("(今天签到即可得到额外奖励)")])),_:1})):u("",!0),c(M,null,{default:d((()=>[h("已经累计签到"),c(C,{class:"p-0-10 text2 fb"},{default:d((()=>[h(g(n.days),1)])),_:1}),h("天")])),_:1})])),_:1}),c(M,{class:"signin-click1"},{default:d((()=>[c(M,{class:"signin-click2"},{default:d((()=>[n.is_sign?(l(),i(M,{key:1,class:"signin-click4 d-c d-c-c"},{default:d((()=>[c(C,null,{default:d((()=>[h("今日")])),_:1}),c(C,null,{default:d((()=>[h("已签")])),_:1})])),_:1})):(l(),i(M,{key:0,class:"signin-click3",onClick:y(w.onSign,["stop"])},{default:d((()=>[c(M,{class:"signin-click"},{default:d((()=>[h("签到")])),_:1})])),_:1},8,["onClick"]))])),_:1})])),_:1})])),_:1}),c(M,{class:"sign-main"},{default:d((()=>[c(M,{class:"sign-main-bg"},{default:d((()=>[c(M,{class:"sign-calendar-wrap"},{default:d((()=>[c(M,{class:"date-text"},{default:d((()=>[c(C,{style:{"font-size":"28rpx"},class:"mr20 icon iconfont icon-sanjiao1 dominant"}),c(C,null,{default:d((()=>[h(g(n.today_year)+"-"+g(n.today_month),1)])),_:1}),c(C,{style:{"font-size":"28rpx"},class:"ml20 icon iconfont icon-sanjiao1 dominant"})])),_:1}),c(M,{class:"week-list"},{default:d((()=>[(l(!0),f(m,null,_(n.weeklist,((t,e)=>(l(),i(M,{class:"week-item",key:e},{default:d((()=>[h(g(t),1)])),_:2},1024)))),128))])),_:1}),c(M,{class:"date-list-wrap"},{default:d((()=>[(l(!0),f(m,null,_(n.daylist,((t,e)=>(l(),i(M,{class:o(["date-item",0!=t.type?"secondary-date-item":""]),key:e},{default:d((()=>[n.list.indexOf(t.day)>-1&&0==t.type?(l(),i(C,{key:0,class:"icon-box"},{default:d((()=>[h(g(t.day),1)])),_:2},1024)):u("",!0),-1==n.list.indexOf(t.day)?(l(),f(m,{key:1},[n.reward.indexOf(t.day-n.today)>-1&&0==t.type?(l(),i(C,{key:0,class:"iconfont icon-libao"})):u("",!0),0==t.type&&-1==n.reward.indexOf(t.day-n.today)?(l(),i(M,{key:1},{default:d((()=>[c(C,null,{default:d((()=>[h(g(t.day),1)])),_:2},1024)])),_:2},1024)):u("",!0)],64)):u("",!0)])),_:2},1032,["class"])))),128))])),_:1})])),_:1})])),_:1}),c(M,{class:"rule-box"},{default:d((()=>[c(M,{class:"rule-title"},{default:d((()=>[h("活动规则")])),_:1}),c(M,{class:"content p30 bg-white f30 lh200 radius8",innerHTML:n.rule},null,8,["innerHTML"])])),_:1})])),_:1})])),_:1},8,["data-theme","class"]))}],["__scopeId","data-v-651ad7df"]]);export{w as default};
