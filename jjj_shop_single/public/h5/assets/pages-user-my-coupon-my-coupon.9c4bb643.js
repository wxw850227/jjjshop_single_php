import{_ as t,v as a,x as e,o as l,c as s,w as o,g as i,b as n,n as c,d as u,f as p,r as _,F as d,q as r,j as g,k as f,S as y,t as h,e as m,u as k}from"./index-024cd044.js";import{u as b}from"./uni-load-more.46aeda4b.js";const w=t({components:{uniLoadMore:b},data:()=>({phoneHeight:0,scrollviewHigh:0,state_active:0,page:1,last_page:0,list_rows:15,listData:[],no_more:!1,loading:!1,data_type:"not_use"}),mounted(){this.init()},onShow(){this.initData(),this.getData()},computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},methods:{init(){let t=this;a({success(a){t.phoneHeight=a.windowHeight,e().select(".top-tabbar").boundingClientRect((a=>{let e=t.phoneHeight-a.height;t.scrollviewHigh=e})).exec()}})},initData(){this.listData=[],this.page=1,this.no_more=!1},getData(){let t=this;t.loading=!0;let a=t.data_type;t._get("user.coupon/lists",{page:t.page,list_rows:t.list_rows,data_type:a},(function(a){if(t.loading=!1,t.listData=t.listData.concat(a.data.list.data),t.last_page=a.data.list.last_page,a.data.list.last_page<=1)return t.no_more=!0,!1}))},scrolltolowerFunc(){let t=this;t.no_more||(t.page++,t.page<=t.last_page?t.getData():t.no_more=!0)},stateFunc(t){let a=this;a.state_active!=t&&(0==t&&(a.data_type="not_use"),1==t&&(a.data_type="is_use"),2==t&&(a.data_type="is_expire"),a.state_active=t,a.initData(),a.getData())},scrolltoupperFunc(){console.log("滚动视图区域到顶")},lookRule(t){t.rule=!0},closeRule(t){t.rule=!1}}},[["render",function(t,a,e,b,w,x){const v=i,D=g,C=f("uni-load-more"),F=y;return l(),s(v,null,{default:o((()=>[n(v,{class:"top-tabbar"},{default:o((()=>[n(v,{class:c(0==w.state_active?"tab-item active":"tab-item"),onClick:a[0]||(a[0]=t=>x.stateFunc(0))},{default:o((()=>[u("未使用")])),_:1},8,["class"]),n(v,{class:c(1==w.state_active?"tab-item active":"tab-item"),onClick:a[1]||(a[1]=t=>x.stateFunc(1))},{default:o((()=>[u("已使用")])),_:1},8,["class"]),n(v,{class:c(2==w.state_active?"tab-item active":"tab-item"),onClick:a[2]||(a[2]=t=>x.stateFunc(2))},{default:o((()=>[u("已过期")])),_:1},8,["class"])])),_:1}),n(F,{"scroll-y":"true",class:"scroll-Y",style:r("height:"+w.scrollviewHigh+"px;"),"lower-threshold":"50",onScrolltoupper:x.scrolltoupperFunc,onScrolltolower:x.scrolltolowerFunc},{default:o((()=>[n(v,{class:"p30 bg-white"},{default:o((()=>[(l(!0),p(d,null,_(w.listData,((e,i)=>(l(),s(v,{class:"item-wrap mb20",key:i},{default:o((()=>[n(v,{class:c(0==e.is_expire&&0==e.is_use?"coupon-item coupon-item-"+e.color.text:"coupon-item coupon-item-gray")},{default:o((()=>[n(v,{class:"circles"},{default:o((()=>[(l(),p(d,null,_(8,((t,a)=>n(D,{key:a}))),64))])),_:1}),n(v,{class:"info"},{default:o((()=>[n(v,null,{default:o((()=>[u(h(e.coupon_type.text),1)])),_:2},1024)])),_:2},1024),n(v,{class:"operation d-b-c"},{default:o((()=>[n(v,{class:"flex-1 coupon-content"},{default:o((()=>[n(v,null,{default:o((()=>[10==e.coupon_type.value?(l(),s(v,{key:0,class:"price"},{default:o((()=>[n(D,{class:"f40 fb"},{default:o((()=>[u("减"+h(1*e.reduce_price)+"元",1)])),_:2},1024)])),_:2},1024)):m("",!0),20==e.coupon_type.value?(l(),p(d,{key:1},[n(D,{class:"f40 fb"},{default:o((()=>[u(h(e.discount),1)])),_:2},1024),n(D,null,{default:o((()=>[u("折")])),_:1})],64)):m("",!0)])),_:2},1024),n(v,{class:"f30"},{default:o((()=>[u(h(e.min_price>0?"满"+1*e.min_price+"元可用":"无门槛"),1)])),_:2},1024),n(v,{class:"f24"},{default:o((()=>[u(" 有效期："+h(e.start_time.text)+"至"+h(e.end_time.text),1)])),_:2},1024)])),_:2},1024),n(v,{class:"right-box d-c-c"},{default:o((()=>[e.state.value>0?(l(),p(d,{key:0},[10!=e.apply_range?(l(),s(v,{key:0,type:"default",class:"f30",onClick:k((a=>t.gotoPage("/pages/coupon/detail?coupon_id="+e.coupon_id+"&apply_range="+e.apply_range)),["stop"])},{default:o((()=>[u(" 立即使用 ")])),_:2},1032,["onClick"])):(l(),s(v,{key:1,type:"default",class:"f30",onClick:a[3]||(a[3]=k((a=>t.gotoPage("/pages/index/index")),["stop"]))},{default:o((()=>[u(" 立即使用 ")])),_:1}))],64)):(l(),s(v,{key:1,class:"f30"},{default:o((()=>[n(D,null,{default:o((()=>[u(h(e.state.text),1)])),_:2},1024)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"]),20==e.apply_range?(l(),s(v,{key:0,class:"range_item d-b-c",onClick:k((a=>t.gotoPage("/pages/coupon/detail?coupon_id="+e.coupon_id+"&apply_range="+e.apply_range)),["stop"])},{default:o((()=>[n(v,null,{default:o((()=>[u("仅可购买指定部分商品")])),_:1}),n(v,null,{default:o((()=>[n(D,{class:"icon iconfont icon-jiantou",style:{color:"#999999","font-size":"24rpx"}})])),_:1})])),_:2},1032,["onClick"])):m("",!0),30==e.apply_range?(l(),s(v,{key:1,class:"range_item d-b-c",onClick:k((a=>t.gotoPage("/pages/coupon/detail?coupon_id="+e.coupon_id+"&apply_range="+e.apply_range)),["stop"])},{default:o((()=>[n(v,null,{default:o((()=>[u("仅可购买指定分类商品")])),_:1}),n(v,null,{default:o((()=>[n(D,{class:"icon iconfont icon-jiantou",style:{color:"#999999","font-size":"24rpx"}})])),_:1})])),_:2},1032,["onClick"])):m("",!0)])),_:2},1024)))),128))])),_:1}),0!=w.listData.length||w.loading?(l(),s(C,{key:1,loadingType:x.loadingType},null,8,["loadingType"])):(l(),s(v,{key:0,class:"d-c-c p30"},{default:o((()=>[n(D,{class:"iconfont icon-wushuju"}),n(D,{class:"cont"},{default:o((()=>[u("亲，暂无相关记录哦")])),_:1})])),_:1}))])),_:1},8,["style","onScrolltoupper","onScrolltolower"])])),_:1})}],["__scopeId","data-v-4e60e88c"]]);export{w as default};
