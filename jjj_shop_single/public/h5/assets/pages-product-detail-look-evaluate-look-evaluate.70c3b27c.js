import{_ as a,a3 as t,v as e,x as s,o as l,c,w as o,g as i,b as n,n as d,d as r,t as u,f as g,r as _,F as p,q as m,j as f,i as h,k as v,S as b,e as y}from"./index-024cd044.js";import{u as w}from"./uni-load-more.46aeda4b.js";import{_ as k}from"./none.d685a420.js";const D=a({components:{uniLoadMore:w},data:()=>({phoneHeight:0,scrollviewHigh:0,state_active:-1,product_id:0,tableData:[],Total:{all:0,negative:0,praise:0,negative:0,review:0},page:1,list_rows:15,no_more:!1,loading:!0,last_page:0}),computed:{loadingType(){return this.loading?1:0!=this.tableData.length&&this.no_more?2:0}},onLoad(a){this.product_id=a.product_id},mounted(){this.init(),this.getData()},methods:{previewImage(a){console.log(a),t({urls:[a],current:a,fail(a){console.log(a),this.showError(a)}})},init(){let a=this;e({success(t){a.phoneHeight=t.windowHeight,s().select(".top-tabbar").boundingClientRect((t=>{let e=a.phoneHeight-t.height;a.scrollviewHigh=e})).exec()}})},getData(){let a=this,t=a.product_id;a._get("product.comment/lists",{product_id:t,scoreType:a.state_active,page:a.page,list_rows:a.list_rows},(function(t){a.loading=!1,a.Total=t.data.total,a.tableData=a.tableData.concat(t.data.list.data),a.last_page=t.data.list.last_page,t.data.list.last_page<=1&&(a.no_more=!0)}))},scrolltolowerFunc(){let a=this;if(a.bottomRefresh=!0,a.page++,a.loading=!0,a.page>a.last_page)return a.loading=!1,void(a.no_more=!0);a.getData()},stateFunc(a){let t=this;t.state_active!=a&&(t.tableData=[],t.no_more=!1,t.loading=!0,t.state_active=a,t.page=1,t.getData())}}},[["render",function(a,t,e,s,w,D){const F=i,T=f,j=h,x=v("uni-load-more"),C=b;return l(),c(F,{class:"look-evaluate"},{default:o((()=>[n(F,{class:"top-tabbar"},{default:o((()=>[n(F,{class:d(-1==w.state_active?"tab-item active":"tab-item"),onClick:t[0]||(t[0]=a=>D.stateFunc(-1))},{default:o((()=>[r(" 全部("+u(w.Total.all)+")",1)])),_:1},8,["class"]),n(F,{class:d(10==w.state_active?"tab-item active":"tab-item"),onClick:t[1]||(t[1]=a=>D.stateFunc(10))},{default:o((()=>[n(F,{class:"d-c-c mr20"},{default:o((()=>[n(T,{class:"icon iconfont icon-pingjiahaoping"}),n(T,{class:"ml10 gray9"},{default:o((()=>[r("好评("+u(w.Total.praise)+")",1)])),_:1})])),_:1})])),_:1},8,["class"]),n(F,{class:d(20==w.state_active?"tab-item active":"tab-item"),onClick:t[2]||(t[2]=a=>D.stateFunc(20))},{default:o((()=>[n(F,{class:"d-c-c mr20"},{default:o((()=>[n(T,{class:"icon iconfont icon-pingjiazhongping"}),n(T,{class:"ml10 gray9"},{default:o((()=>[r("中评("+u(w.Total.review)+")",1)])),_:1})])),_:1})])),_:1},8,["class"]),n(F,{class:d(30==w.state_active?"tab-item active":"tab-item"),onClick:t[3]||(t[3]=a=>D.stateFunc(30))},{default:o((()=>[n(F,{class:"d-c-c mr20"},{default:o((()=>[n(T,{class:"icon iconfont icon-pingjiachaping"}),n(T,{class:"ml10 gray9"},{default:o((()=>[r("差评("+u(w.Total.negative)+")",1)])),_:1})])),_:1})])),_:1},8,["class"])])),_:1}),n(C,{"scroll-y":"true",class:"scroll-Y",style:m("height:"+w.scrollviewHigh+"px;"),"lower-threshold":"50",onScrolltolower:D.scrolltolowerFunc},{default:o((()=>[n(F,{class:"comment-list"},{default:o((()=>[(l(!0),g(p,null,_(w.tableData,((a,t)=>(l(),c(F,{class:"item",key:t},{default:o((()=>[n(F,{class:"cmt-user"},{default:o((()=>[n(F,{class:"left"},{default:o((()=>[n(j,{class:"photo",src:a.users.avatarUrl,mode:"aspectFill"},null,8,["src"]),n(T,{class:"name"},{default:o((()=>[r(u(a.users.nickName),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),n(F,{class:"d-b-c p20"},{default:o((()=>[n(F,{class:"d-s-c"},{default:o((()=>[10==a.score?(l(),c(F,{key:0,class:"d-c-c mr20"},{default:o((()=>[n(T,{class:"icon iconfont icon-pingjiahaoping"}),n(T,{class:"ml10 gray9"},{default:o((()=>[r("好评")])),_:1})])),_:1})):y("",!0),20==a.score?(l(),c(F,{key:1,class:"d-c-c mr20"},{default:o((()=>[n(T,{class:"icon iconfont icon-pingjiazhongping"}),n(T,{class:"ml10 gray9"},{default:o((()=>[r("中评")])),_:1})])),_:1})):y("",!0),30==a.score?(l(),c(F,{key:2,class:"d-c-c mr20"},{default:o((()=>[n(T,{class:"icon iconfont icon-pingjiachaping"}),n(T,{class:"ml10 gray9"},{default:o((()=>[r("差评")])),_:1})])),_:1})):y("",!0)])),_:2},1024),n(T,{class:"datetime gray9"},{default:o((()=>[r(u(a.create_time),1)])),_:2},1024)])),_:2},1024),n(F,{class:"p-0-20 f24 gray3"},{default:o((()=>[r(u(a.content),1)])),_:2},1024),n(F,{class:"imgs d-s-c p-0-20"},{default:o((()=>[(l(!0),g(p,null,_(a.image,((a,t)=>(l(),c(F,{class:"box",key:t},{default:o((()=>[n(j,{onClick:t=>D.previewImage(a.file_path),src:a.file_path,mode:"aspectFill",width:""},null,8,["onClick","src"])])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128)),0!=w.tableData.length||w.loading?(l(),c(x,{key:1,loadingType:D.loadingType},null,8,["loadingType"])):(l(),c(F,{key:0,class:"d-c-c p30"},{default:o((()=>[n(F,{class:"none-data-box"},{default:o((()=>[n(j,{src:k,mode:"widthFix"}),n(T,null,{default:o((()=>[r("亲，暂无相关记录哦")])),_:1})])),_:1})])),_:1}))])),_:1})])),_:1},8,["style","onScrolltolower"])])),_:1})}],["__scopeId","data-v-d5bd3ee1"]]);export{D as default};
