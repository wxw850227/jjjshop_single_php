import{_ as e,v as s,z as t,a as o,y as l,s as a,A as i,af as d,o as r,c as n,w as u,n as c,q as p,g as _,b as g,d as m,e as f,j as b,I as w,h}from"./index-024cd044.js";const v=e({data:()=>({formData:{mobile:""},loging_password:"",register:{mobile:"",password:"",repassword:"",code:""},resetpassword:{mobile:"",password:"",repassword:"",code:""},ip:"",isShow:!0,is_login:1,is_code:!0,phoneHeight:0,isRead:!0}),onLoad(){this.getData()},onShow(){this.init()},methods:{init(){let e=this;s({success(s){e.phoneHeight=s.windowHeight}})},getData(){let e=this;e._get("index/policy",{platform:e.getPlatform(),referee_id:t("referee_id")},(function(s){console.log(s),e.service=s.data.service,e.privacy=s.data.privacy}))},formSubmit(){let e=this,s={mobile:e.formData.mobile},d="";if(e.isRead)return/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.formData.mobile)?void(""!=e.loging_password?(s.password=e.loging_password,d="user.userweb/login",l({title:"正在提交"}),e._post("user.userweb/login",s,(s=>{a("token",s.data.token),a("user_id",s.data.user_id);let o="/"+t("currentPage"),l=t("currentPageOptions");if(Object.keys(l).length>0){o+="?";for(let e in l)o+=e+"="+l[e]+"&";o=o.substring(0,o.length-1)}e.gotoPage(o)}),!1,(()=>{i()}))):o({title:"密码不能为空！",duration:2e3,icon:"none"})):(console.log(e.formData.mobile),void o({title:"手机有误,请重填！",duration:2e3,icon:"none"}));o({title:"请同意并勾选协议内容",duration:2e3,icon:"none"})},registerSub(){let e=this;if(e.isRead)return/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.register.mobile)?void(e.register.password.length<6?o({title:"密码至少6位数！",duration:2e3,icon:"none"}):e.register.password===e.register.repassword?(e.register.invitation_id=t("invitation_id")?t("invitation_id"):0,e.register.reg_source="h5",e.register.referee_id=t("referee_id"),l({title:"正在提交"}),e._post("user.userweb/register",e.register,(s=>{o({title:"注册成功",duration:3e3}),e.formData.mobile=e.register.mobile,e.register={mobile:"",password:"",repassword:"",code:""},e.second=0,e.changeMsg(),e.is_login=1}),!1,(()=>{i()}))):o({title:"两次密码输入不一致！",duration:2e3,icon:"none"})):(console.log(e.register.mobile),void o({title:"手机有误,请重填！",duration:2e3,icon:"none"}));o({title:"请同意并勾选协议内容",duration:2e3,icon:"none"})},resetpasswordSub(){let e=this;/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.resetpassword.mobile)?""!=e.resetpassword.code?e.resetpassword.password.length<6?o({title:"密码至少6位数！",duration:2e3,icon:"none"}):e.resetpassword.password===e.resetpassword.repassword?(l({title:"正在提交"}),e._post("user.useropen/resetpassword",e.resetpassword,(s=>{o({title:"重置成功",duration:3e3}),e.formData.mobile=e.resetpassword.mobile,e.resetpassword={mobile:"",password:"",repassword:"",code:""},e.second=0,e.changeMsg(),e.is_login=1}),!1,(()=>{i()}))):o({title:"两次密码输入不一致！",duration:2e3,icon:"none"}):o({title:"验证码不能为空！",duration:2e3,icon:"none"}):o({title:"手机有误,请重填！",duration:2e3,icon:"none"})},isCode(){this.is_code?this.$set(this,"is_code",!1):this.$set(this,"is_code",!0),console.log(this.is_code)},sendCode(){let e=this;if(1==e.is_login){if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.formData.mobile))return void o({title:"手机有误,请重填！",duration:2e3,icon:"none"})}else if(2==e.is_login){if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.register.mobile))return void o({title:"手机有误,请重填！",duration:2e3,icon:"none"})}else if(0==e.is_login&&!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.resetpassword.mobile))return void o({title:"手机有误,请重填！",duration:2e3,icon:"none"});let s="register",t=e.register.mobile;1==e.is_login?(s="login",t=e.formData.mobile):0==e.is_login&&(s="login",t=e.resetpassword.mobile),e._post("user.useropen/sendCode",{mobile:t,type:s},(s=>{1==s.code&&(o({title:"发送成功"}),e.is_send=!0,e.changeMsg())}))},changeMsg(){this.second>0?(this.send_btn_txt=this.second+"秒",this.second--,setTimeout(this.changeMsg,1e3)):(this.send_btn_txt="获取验证码",this.second=60,this.is_send=!1)},xieyi(e){let s="";s="service"==e?this.service:this.privacy,d({url:"/pages/webview/webview?url="+s})}}},[["render",function(e,s,t,o,l,a){const i=_,d=b,v=w,x=h;return r(),n(i,{"data-theme":e.theme(),class:c([e.theme()||"","login-container"]),style:p("height: "+l.phoneHeight+"px;")},{default:u((()=>[g(i,{class:"skip",onClick:s[0]||(s[0]=s=>e.gotoPage("/pages/index/index"))},{default:u((()=>[m("跳过→")])),_:1}),2==l.is_login?(r(),n(i,{key:0,class:"p-30-75"},{default:u((()=>[g(i,{class:"login_topbpx"},{default:u((()=>[g(i,{class:"login_tit"},{default:u((()=>[m("注册")])),_:1}),g(i,{class:"login_top"},{default:u((()=>[m("已有账户，"),g(d,{class:"dominant",onClick:s[1]||(s[1]=e=>l.is_login=1)},{default:u((()=>[m("立即登录")])),_:1})])),_:1})])),_:1}),g(i,{class:"group-bd"},{default:u((()=>[g(i,{class:"form-level d-s-c"},{default:u((()=>[g(i,{class:"val flex-1 input_botom"},{default:u((()=>[g(v,{type:"text",modelValue:l.register.mobile,"onUpdate:modelValue":s[2]||(s[2]=e=>l.register.mobile=e),placeholder:"请填写手机号",disabled:e.is_send},null,8,["modelValue","disabled"])])),_:1})])),_:1}),g(i,{class:"form-level d-s-c"},{default:u((()=>[g(i,{class:"val flex-1 input_botom"},{default:u((()=>[g(v,{type:"text",password:"true",modelValue:l.register.password,"onUpdate:modelValue":s[3]||(s[3]=e=>l.register.password=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})])),_:1}),g(i,{class:"form-level d-s-c"},{default:u((()=>[g(i,{class:"val flex-1 input_botom"},{default:u((()=>[g(v,{type:"text",password:"true",modelValue:l.register.repassword,"onUpdate:modelValue":s[4]||(s[4]=e=>l.register.repassword=e),placeholder:"请确认密码"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})):f("",!0),1==l.is_login?(r(),n(i,{key:1,class:"p-30-75"},{default:u((()=>[g(i,{class:"login_topbpx"},{default:u((()=>[g(i,{class:"login_tit"},{default:u((()=>[m("登录")])),_:1}),g(i,{class:"login_top"},{default:u((()=>[m("还没有账号，"),g(d,{class:"dominant",onClick:s[5]||(s[5]=e=>l.is_login=2)},{default:u((()=>[m("立即注册")])),_:1})])),_:1})])),_:1}),g(i,{class:"group-bd"},{default:u((()=>[g(i,{class:"form-level d-s-c"},{default:u((()=>[g(i,{class:"val flex-1 input_botom"},{default:u((()=>[g(v,{type:"text",modelValue:l.formData.mobile,"onUpdate:modelValue":s[6]||(s[6]=e=>l.formData.mobile=e),placeholder:"请填写手机号"},null,8,["modelValue"])])),_:1})])),_:1}),g(i,{class:"form-level d-s-c"},{default:u((()=>[g(i,{class:"val flex-1 input_botom"},{default:u((()=>[g(v,{type:"text",password:"true",modelValue:l.loging_password,"onUpdate:modelValue":s[7]||(s[7]=e=>l.loging_password=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})):f("",!0),0==l.is_login?(r(),n(i,{key:2,class:"p-30-75"},{default:u((()=>[g(i,{class:"login_topbpx"},{default:u((()=>[g(i,{class:"login_tit"},{default:u((()=>[m("重置密码")])),_:1}),g(i,{class:"login_top"},{default:u((()=>[g(d,{class:"dominant",onClick:s[8]||(s[8]=e=>l.is_login=1)},{default:u((()=>[m("立即登录")])),_:1})])),_:1})])),_:1}),g(i,{class:"group-bd"},{default:u((()=>[g(i,{class:"form-level d-s-c"},{default:u((()=>[g(i,{class:"val flex-1 input_botom"},{default:u((()=>[g(v,{type:"text",modelValue:l.resetpassword.mobile,"onUpdate:modelValue":s[9]||(s[9]=e=>l.resetpassword.mobile=e),placeholder:"请填写手机号",disabled:e.is_send},null,8,["modelValue","disabled"])])),_:1})])),_:1}),g(i,{class:"form-level d-s-c"},{default:u((()=>[g(i,{class:"val flex-1 input_botom"},{default:u((()=>[g(v,{type:"text",password:"true",modelValue:l.resetpassword.password,"onUpdate:modelValue":s[10]||(s[10]=e=>l.resetpassword.password=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})])),_:1}),g(i,{class:"form-level d-s-c"},{default:u((()=>[g(i,{class:"val flex-1 input_botom"},{default:u((()=>[g(v,{type:"text",password:"true",modelValue:l.resetpassword.repassword,"onUpdate:modelValue":s[11]||(s[11]=e=>l.resetpassword.repassword=e),placeholder:"请确认密码"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})):f("",!0),1==l.is_login?(r(),n(i,{key:3,class:"gray6 p-0-75 d-b-c"},{default:u((()=>[g(i,{onClick:s[12]||(s[12]=e=>l.is_login=0)},{default:u((()=>[m("忘记密码?")])),_:1})])),_:1})):f("",!0),g(i,{onClick:s[15]||(s[15]=e=>l.isRead=!l.isRead),class:"d-s-c gray6 p-0-75 mt20"},{default:u((()=>[g(i,{class:c(l.isRead?"active agreement":"agreement")},null,8,["class"]),m("我已阅读并接受"),g(d,{class:"dominant",onClick:s[13]||(s[13]=e=>a.xieyi("service"))},{default:u((()=>[m("《用户协议》")])),_:1}),m("和"),g(d,{class:"dominant",onClick:s[14]||(s[14]=e=>a.xieyi("privacy"))},{default:u((()=>[m("《隐私政策》")])),_:1})])),_:1}),2==l.is_login?(r(),n(i,{key:4,style:{"padding-top":"80rpx"},class:"btns p-30-75"},{default:u((()=>[g(x,{onClick:a.registerSub},{default:u((()=>[m("注册")])),_:1},8,["onClick"])])),_:1})):f("",!0),1==l.is_login?(r(),n(i,{key:5,style:{"padding-top":"80rpx"},class:"btns p-30-75"},{default:u((()=>[g(x,{onClick:a.formSubmit},{default:u((()=>[m("登录")])),_:1},8,["onClick"])])),_:1})):f("",!0),0==l.is_login?(r(),n(i,{key:6,style:{"padding-top":"80rpx"},class:"btns p-30-75"},{default:u((()=>[g(x,{onClick:a.resetpasswordSub},{default:u((()=>[m("重置密码")])),_:1},8,["onClick"])])),_:1})):f("",!0)])),_:1},8,["data-theme","class","style"])}],["__scopeId","data-v-e15a3d20"]]);export{v as default};
