import{_ as e,y as t,z as a,A as c,s as l,a as s,N as m,K as d,o,c as Z,w as i,n,g as r,f as u,b as h,d as A,F as k,r as f,t as p,e as _,h as g,O as b,P as C,Q as D,i as E,j as w,H as V,k as B,u as F}from"./index-024cd044.js";import{_ as v}from"./recommendProduct.3739a011.js";import{r as y}from"./uni-app.es.5973474d.js";const I=e({components:{recommendProduct:v},data:()=>({loadding:!0,isEdit:!1,tableData:[],arrIds:[],checkedAll:!1,totalPrice:0,is_auto:0,clock:!1}),onLoad(){},onShow(){this.getData(),this.getTabBarLinks()},methods:{getData(){t({title:"加载中"});let e=this;e._get("order.cart/lists",{},(function(t){let l=a("TabBar").is_auto&&0!=a("TabBar").is_auto;e.is_auto=l,c(),e.tableData=t.data,e.loadding=!1,e.clock=!1,e._initGoodsChecked()}))},_initGoodsChecked(){let e=this,t=e.getCheckedData();e.tableData.forEach((a=>{a.checked=e.inArray(`${a.cart_id}`,t)})),e.isEdit=!1,e.checkedAll=t.length==e.tableData.length,e.updateTotalPrice()},getCheckedData(){let e=a("CheckedData");return e||[]},checkItem(e,t){e.checked=!e.checked,this.tableData[t]=e,this.onUpdateChecked(),this.updateTotalPrice(),this.checkedAll=this.getCheckedData().length==this.tableData.length},onUpdateChecked(){let e=[];this.tableData.forEach((t=>{1==t.checked&&e.push(`${t.cart_id}`)})),l("CheckedData",e)},onCheckedAll(){let e=this;e.checkedAll=!e.checkedAll,e.tableData.forEach((t=>{t.checked=e.checkedAll})),e.updateTotalPrice(),e.onUpdateChecked()},updateTotalPrice:function(){let e=0,t=this.tableData;for(let a=0;a<t.length;a++)1==t[a].checked&&(e+=t[a].total_num*t[a].product_price);this.totalPrice=e.toFixed(2)},Submit(){let e=[];if(this.tableData.forEach((t=>{1==t.checked&&e.push(`${t.cart_id}`)})),0==e.length)return s({title:"请选择商品",icon:"none"}),!1;this.gotoPage("/pages/order/confirm-order?order_type=cart&cart_ids="+e),console.log()},addFunc(e){let a=this;if(a.clock)return;a.clock=!0;let l=e.product_id,s=e.spec_sku_id;t({title:"加载中"}),a._post("order.cart/add",{product_id:l,spec_sku_id:s,total_num:1},(function(e){c(),a.getData()}),(function(){c(),a.clock=!1}))},reduceFunc(e){let a=this;if(a.clock)return;a.clock=!0;let l=e.product_id,s=e.spec_sku_id;e.total_num<=1||(console.log(e.total_num),t({title:"加载中"}),a._post("order.cart/sub",{product_id:l,spec_sku_id:s},(function(e){console.log("数量-1"),c(),a.getData()}),(function(){c(),a.clock=!1})))},onDelete(){let e=this,t=e.getCheckedIds();if(!t.length)return e.showError("您还没有选择商品"),!1;m({title:"提示",content:"您确定要移除选择的商品吗?",success(a){a.confirm&&e._post("order.cart/delete",{cart_id:t},(function(a){e.onDeleteEvent(t),e.getData()}))}})},getCheckedIds(){let e=[];return this.tableData.forEach((t=>{!0===t.checked&&e.push(`${t.cart_id}`)})),e},onDeleteEvent(e){let t=this;return e.forEach((e=>{t.tableData.forEach(((a,c)=>{e==`${a.cart_id}`&&t.tableData.splice(c,1)}))})),t.onUpdateChecked(),!0},inArray(e,t){for(var a in t)if(t[a]==e)return!0;return!1},gotoShop(){d({url:"/pages/index/index"})}}},[["render",function(e,t,a,c,l,s){const m=g,d=r,I=b,G=C,P=D,W=E,x=w,O=y(V("recommendProduct"),v),R=B("tabBar");return o(),Z(d,{"data-theme":e.theme(),class:n(e.theme()||"")},{default:i((()=>[l.loadding?_("",!0):(o(),Z(d,{key:0,class:"card"},{default:i((()=>[l.tableData.length>0?(o(),u(k,{key:0},[h(d,{class:"address-bar d-e-c"},{default:i((()=>[h(d,{class:"f30",onClick:t[0]||(t[0]=e=>l.isEdit=!l.isEdit)},{default:i((()=>[l.isEdit?(o(),Z(m,{key:0,class:"f24"},{default:i((()=>[A("完成")])),_:1})):(o(),Z(m,{key:1,class:"f24"},{default:i((()=>[A("编辑")])),_:1}))])),_:1})])),_:1}),h(d,{class:"section"},{default:i((()=>[h(d,{class:"supplier_list"},{default:i((()=>[(o(!0),u(k,null,f(l.tableData,((e,t)=>(o(),Z(d,{class:"item",key:t},{default:i((()=>[h(P,{onChange:a=>s.checkItem(e,t)},{default:i((()=>[h(G,{class:"d-c-c"},{default:i((()=>[h(I,{value:"cb",class:"checkbox",checked:e.checked},null,8,["checked"])])),_:2},1024)])),_:2},1032,["onChange"]),h(W,{src:e.product_image,class:"cover",mode:"aspectFit"},null,8,["src"]),h(d,{class:"info"},{default:i((()=>[h(d,{class:"title"},{default:i((()=>[A(p(e.product_name),1)])),_:2},1024),h(d,{class:"describe"},{default:i((()=>[A(p(e.product_sku.product_attr),1)])),_:2},1024),h(d,{class:"level-box count_choose"},{default:i((()=>[h(d,{class:"price"},{default:i((()=>[A(" ¥ "),h(x,{class:"num"},{default:i((()=>[A(p(e.product_price),1)])),_:2},1024)])),_:2},1024),h(d,{class:"num-wrap"},{default:i((()=>[e.total_num>1?(o(),Z(d,{key:0,class:"",onClick:F((t=>s.reduceFunc(e)),["stop"])},{default:i((()=>[h(W,{class:"reduce_icon",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAilBMVEUAAABmZmZmZmZmZmZlZWVpaWlmZmZmZmZoaGhmZmZnZ2dpaWlkZGRnZ2dmZmZmZmZmZmZmZmZmZmZmZmZlZWVmZmZmZmZmZmZmZmZmZmZmZmZnZ2dmZmZmZmZmZmZmZmZmZmZmZmZlZWVlZWVmZmZmZmZmZmZmZmZlZWVmZmZmZmZlZWVlZWVmZmaDiK+QAAAALXRSTlMA+VW9QwXv5BbUJgkPn8703kovHMTYt7ES6aY9h8iOmU99Wip1bZF/qzV4aGAFJZmLAAADDUlEQVRYw6VX6XqrIBBFFFwgGnfjviZq6vu/3h2bfm0ujY0J5ycwh5lhmAX9BmFG5w5lqtpHnQL0o62m5eB2BiNoB4jRZXiuIlt3li84uh1VM846YwcDs3A+BqZOleUOCtXNYMyxxZ6Ic8vt0/AmEdpFEKhqEBR2eOML0961+F/yidbE5mlV2oyr5trWrqa5dXttqthcDTqZcaMlf2l/tj+PqYfLh+b5jNyc6nvax+WgflLb5007yNTHR9D0mPb1ZPmc3G1x35rqPj2Cbce4nx4y8KwJFNiP8tZijxVs8+gIR4Im4w/ktdIGM80SewbZemAPn01wkF1q/IE8bJ3Ui7glHssLCtf8YmDZOVSWU3zt+JN39oaILkp4zv4zk3iX9f7xw0dPYV3jE+hw8cj94lwoC41bf0+o+20MOhSz9bOU4Ajko6uPdsH/WBkinJDv+DvDAxcDUO5kuKoQLufvmLSaQlHC3EO70V1MRSmarxuZGzvAB27dDZKBzk7sfooQqzcXRcUJegEJVpXF7C2yhhdO6SIY8BxeHi40xQaBCM9NhY7YeI3AwCNVzLxjyMhG56bMbnwb7oyZgTocgAdqhl4Eq8ELAe6QO4Mx1YRexlSB62YXDZWumPCiL8NqTEWvBlRGlEbCJ9oZ0KtkiVIbeDT+OgHXQHc7Raq+hOvXfBmQAsJFVxHkMXvw0RvwBxuyG4IsWbT8HQLeFpCDEWSXoCbvEJA6gCyGKBC46C24QEBXAvWOgCTWpG1ispI7ZTX1AQGfhlTdRDpMXCAQTUjqA102QQ91IpggOhEInG0CBwgEJ4rPyLO80DdR5BkXnlEMJOa15SE9PAIsl63HhEASQxkKqIs34ULhFUNZ/EyEJ8YmEk7EzyT9naUTinRKk0yqbSef1lknV1ikShtcS94urtGtuEqXd/kG46fFCd5ocaSbrHfbvPF0a/MkG00m2+puNNvZs2Y7uGu2RYYd7X651e4DQ3YpZAYOODDN+0aeeWKyQ5f02Ld/8FQB+wdP+dFXfvgWx/8TdRx6+nP8/wdWpoH8K7QZOAAAAABJRU5ErkJggg==",mode:""})])),_:2},1032,["onClick"])):_("",!0),h(d,{class:"text-wrap"},{default:i((()=>[A(p(e.total_num),1)])),_:2},1024),e.total_num<e.product_sku.stock_num?(o(),Z(d,{key:1,class:"",onClick:F((t=>s.addFunc(e)),["stop"])},{default:i((()=>[h(W,{class:"add_icon",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAjVBMVEUAAABpaWlnZ2dmZmZmZmZmZmZmZmZkZGRnZ2dmZmZlZWVmZmZmZmZpaWlmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZlZWVnZ2dmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZlZWVmZmZlZWVmZmZmZmZlZWVmZmZmZmYQR7WMAAAALnRSTlMABSb5WO++ERbSQXzVCY8NalLF9Lh2cM7YRSobMd5L4umx5aCrl6bJOGCCiR+blsmQzgAAA9xJREFUWMO1V+caqjAMLVCGlFlApgxlOnj/x7sBR70y1Ot3zy8pcpqk6UmCpuB0JUoto5b83V4E7He+VBtWGik6hz4Ap0Qq9irXz5z+Bifz3crDaqR8wKDz+FhSLROF/gmCmGm0PGJeR+sw+XRbB9cvAr+hEoA2fnDlC+ptystoBbJKik0+GK0VFbGwnYZhamOLVIU2OJRvChLKK9bbhj/+TbqQLoxic3SZM+Mo7MhFGql9w17yg0u8YgeW7mrPbvlY5p5eyTHf2l69A992hZfMMpgtoQK8d08QqoXwnlzYQaCkNefcNzbg5sbAicItHXCCDQ0CtDFUebK/OrzKpaP6JsonKva9Zqjmi3mtEQh9XliR+eacE8sVeyEwWv3v+JEN7F92Z/QWvFXk4CpJuOdFD+InFjj+JNXPuAAbGo9/OiTswveudUYf4dwNDC5+HLQcGnDAdAuUHzJYEqSL8chJnjSCEJwS9DGioyYIDbntqKeF02eGqn9OwKlG1jtFqo8PvKeNHqEvMEZN83huSC9cin1wimZ3MmXZnM3L5BT0YokVDjIc/Bl+zmVNlHZdOptbw7aCdox0pKilczVmihjXTVNPsuPhuFOqCoowhQjY+vyfApCheXLdhihQHKGUgDOXBM0T7OC85wlQcoHQkRRZVSZohJ8n2G4g67fzBDzRhKyykOGKotvF3xPE3fClgWofeEL5ewI5BNv9Gkl78CThvifgEojeXkK+0/tWjL4nQLG16R0fgUo22PwXAhM3oMEI1IXaCyqqWH4P9ikLN8qmoGIIJFJK0TziK8GSToWgCuJIED6XEL5Vbwi7akikqgvvKy0vc28IzHZbS3fQwIEqENDHQr1tzReCVxfk9CD2ixAP6VPGpAPBI4iMwFkmcIDgJYivx2iqR7ofke33uSgMnUI+PIygR9V8OcbXRDIjfDqMuBwOZSOCkU05PIw44cj864wc/5HKrICGGNsjsHXI+j47WPdnHELhfUlldpmYDCo3xC3RoJCSNr6vMIFkl2nlOqPzNZXPaOU6rwkKVKCBACreiqCsS9rVglVJY6L6FQETVSbr3xEwWdcjVlg+J2CFhZW2hV0WrIvupW2tuIIFAwFYsFxc18o7EFjUcag1JYDyvruVd9ZgHJNprtgVpZUdTx0grMFYa3HkBHseTuQJ8dDisAuw3GRBm83z8aRBiFmTxdq85ps2r8xZm/dDo6n/2ur+2mz/2u7/PnBMof8w8vw8dDGhfBn7QsDa2Ddl4FNvbfD0YPD8n6MvG74JDN97NnzvYfgma8P3dPzfjuN/LjqOmI/j/3Zh/P8DDsSbMWz1m30AAAAASUVORK5CYII=",mode:""})])),_:2},1032,["onClick"])):_("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})],64)):(o(),Z(d,{key:1,class:"none-data-box cart_none"},{default:i((()=>[h(W,{class:"cart_none_img",src:"/h5/assets/cart_none-cff73f30.png",mode:"widthFix"}),h(x,{class:"f26 gray9 pt10"},{default:i((()=>[A("购物车空空如也")])),_:1}),h(m,{type:"default",class:"theme-btn mt30 ww100 none_btn",onClick:s.gotoShop},{default:i((()=>[A("去购物")])),_:1},8,["onClick"])])),_:1})),l.tableData.length>0?(o(),Z(d,{key:2,class:n(["bottom-btns f28",l.is_auto?"is_auto":""])},{default:i((()=>[h(P,{onChange:s.onCheckedAll},{default:i((()=>[h(G,{class:"d-c-c mr20"},{default:i((()=>[h(I,{color:"red",class:"checkbox",checked:l.checkedAll,value:"cb"},null,8,["checked"]),A(" 全选 ")])),_:1})])),_:1},8,["onChange"]),l.isEdit?(o(),Z(d,{key:1,class:""},{default:i((()=>[h(m,{type:"primary",onClick:t[2]||(t[2]=e=>s.onDelete()),class:"delete-btn theme-btn mr20"},{default:i((()=>[A("删除")])),_:1})])),_:1})):(o(),Z(d,{key:0,class:"d-e-c"},{default:i((()=>[h(d,{class:"total d-s-c flex-1 mr20"},{default:i((()=>[h(x,null,{default:i((()=>[A("合计：")])),_:1}),h(d,{class:"price f22"},{default:i((()=>[A(" ¥ "),h(x,{class:"num f40"},{default:i((()=>[A(p(l.totalPrice),1)])),_:1})])),_:1})])),_:1}),h(m,{type:"primary",class:"buy-btn theme-btn",onClick:t[1]||(t[1]=e=>s.Submit())},{default:i((()=>[A("去结算")])),_:1})])),_:1}))])),_:1},8,["class"])):_("",!0),h(O,{location:10})])),_:1})),h(R)])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-af2ef957"]]);export{I as default};
