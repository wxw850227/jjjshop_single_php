import{_ as t,s as e,a,o as s,c as o,w as l,b as i,n as c,d as n,t as r,e as d,f as u,r as p,F as h,i as g,g as _,h as f,j as m,k as y,l as x,m as b,p as k,q as w,u as C,I as P,v as T,x as v,y as S,z as B,A as H,B as I,C as j,D as F,E as D,G as L,H as R}from"./index-024cd044.js";import{_ as W,a as M}from"./diy.83719db6.js";import{r as Q}from"./uni-app.es.5973474d.js";import{P as U}from"./uni-popup.95b83736.js";import{u as V}from"./uni-load-more.46aeda4b.js";/* empty css                                                                  */const q=t({components:{diy:W,Homepush:t({components:{Popup:U},data:()=>({isPopup:!1,type:0,width:600,height:800,backgroundColor:"none",boxShadow:"none",form:{},coupon:[]}),props:["homepush_data"],created(){},mounted(){this.setData()},methods:{setData(){this.isPopup=!0,this.form=this.homepush_data,this.type=this.homepush_data.type,this.coupon=this.homepush_data.coupon},hidePopupFunc(t){e("homepush_name",this.homepush_data.name),this.isPopup=!1},jumpPage(t){this.hidePopupFunc(),this.gotoPage("/"+t)},getCoupon(){let t=this,e=[];t.coupon.forEach((t=>{e.push(t.coupon_id)})),t._get("user.coupon/receiveList",{coupon_ids:JSON.stringify(e)},(function(e){a({title:"领取成功",icon:"success",mask:!0,duration:2e3}),t.hidePopupFunc()}))}}},[["render",function(t,e,a,x,b,k){const w=g,C=_,P=f,T=m,v=y("Popup");return s(),o(C,{class:"home-push-wrap"},{default:l((()=>[i(v,{show:b.isPopup,width:b.width,height:b.height,backgroundColor:b.backgroundColor,boxShadow:b.boxShadow,padding:0,onHidePopup:k.hidePopupFunc},{default:l((()=>[i(C,{class:c(["home-push",1==b.type||3==b.type?"home-push-bg":""])},{default:l((()=>[1==b.type?(s(),o(C,{key:0,class:"image-text"},{default:l((()=>[i(C,{class:"pic"},{default:l((()=>[i(w,{src:b.form.file_path,mode:"aspectFill"},null,8,["src"])])),_:1}),i(C,{class:"title"},{default:l((()=>[n(r(b.form.title),1)])),_:1}),i(C,{class:"des"},{default:l((()=>[n(r(b.form.remark),1)])),_:1}),i(C,{class:"btns"},{default:l((()=>[i(P,{type:"primary",onClick:e[0]||(e[0]=t=>k.jumpPage(b.form.link.url))},{default:l((()=>[n(r(b.form.des),1)])),_:1})])),_:1})])),_:1})):d("",!0),2==b.type?(s(),o(C,{key:1,class:"image-only",onClick:e[1]||(e[1]=t=>k.jumpPage(b.form.link.url))},{default:l((()=>[i(C,{class:"pic"},{default:l((()=>[i(w,{src:b.form.file_path,mode:"aspectFill"},null,8,["src"])])),_:1})])),_:1})):d("",!0),3==b.type?(s(),o(C,{key:2,class:"cuopon"},{default:l((()=>[null!=b.form.file_path&&""!=b.form.file_path?(s(),o(C,{key:0,class:"cuopon-title d-c-c"},{default:l((()=>[i(w,{src:b.form.file_path,mode:"aspectFill"},null,8,["src"])])),_:1})):d("",!0),i(C,{class:"list"},{default:l((()=>[(s(!0),u(h,null,p(b.coupon,((t,e)=>(s(),o(C,{class:"item",key:e},{default:l((()=>[i(C,{class:"info"},{default:l((()=>[i(C,{class:"num"},{default:l((()=>[i(T,{class:"f30"},{default:l((()=>[n(r(t.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),i(C,{class:"explan"},{default:l((()=>[i(T,{class:"name"},{default:l((()=>[n(r(t.type),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),i(C,{class:"btns"},{default:l((()=>[i(P,{type:"primary",onClick:e[2]||(e[2]=t=>k.getCoupon())},{default:l((()=>[n("立即领取")])),_:1})])),_:1})])),_:1})):d("",!0)])),_:1},8,["class"]),i(C,{class:"close-btns",onClick:e[3]||(e[3]=t=>k.hidePopupFunc(!0))},{default:l((()=>[i(T,{class:"icon iconfont icon-guanbi"})])),_:1})])),_:1},8,["show","width","height","backgroundColor","boxShadow","onHidePopup"])])),_:1})}],["__scopeId","data-v-0f4999fe"]]),navBar:M,uniLoadMore:V,searchProduct:t({data:()=>({form:{},arr:[]}),mounted(){this.getData()},props:["isShow"],methods:{getData(){let t=this;x({key:"search_list",success:function(e){null!=e&&null!=e.data&&(t.arr=e.data)}})},stopTouchMove:()=>!0,search(t){let e=null;if(null!=t)e=t;else{e=this.form.keyWord;let t=this.arr;if(void 0===e||null==e||""==e)return a({title:"请输入搜索的关键字",icon:"none",duration:2e3}),!1;t.push(e),b({key:"search_list",data:t,success:function(){console.log("success")}})}this.gotoPage("/pages/product/list/list?search="+e+"&category_id=0&sortType=all")},clearStorage(){let t=this;k({key:"search_list",success:function(e){t.arr=[]}})},closeSearch(){this.$emit("close")}}},[["render",function(t,e,a,c,g,f){const y=_,x=m,b=P;return a.isShow?(s(),o(y,{key:0,onTouchmove:C(f.stopTouchMove,["stop","prevent"])},{default:l((()=>[i(y,{class:"search-wrap"},{default:l((()=>[i(y,{class:"state_top"}),i(y,{class:"head_top",style:w("height:"+t.topBarTop()+"px;")},null,8,["style"]),i(y,{class:"index-search-box d-b-c",id:"searchBox",style:w(0==t.topBarHeight()?"":"height:"+t.topBarHeight()+"px;padding-right: 200rpx")},{default:l((()=>[i(y,{class:"reg180",style:w(0==t.topBarHeight()?"":"height:"+t.topBarHeight()+"px;")},{default:l((()=>[i(x,{onClick:f.closeSearch,class:"icon iconfont icon-jiantou"},null,8,["onClick"])])),_:1},8,["style"]),i(y,{class:"index-search t-c flex-1",style:w(0==t.topBarHeight()?"":"height:"+t.topBarHeight()+"px;")},{default:l((()=>[i(x,{class:"icon iconfont icon-sousuo"}),i(b,{type:"text",modelValue:g.form.keyWord,"onUpdate:modelValue":e[0]||(e[0]=t=>g.form.keyWord=t),class:"flex-1 ml10 f30 gray3","placeholder-class":"f24 gray6",placeholder:"输入你要的商品","confirm-type":"search",onConfirm:e[1]||(e[1]=t=>f.search())},null,8,["modelValue"])])),_:1},8,["style"])])),_:1},8,["style"]),i(y,{class:"p-0-20 bg-white"},{default:l((()=>[i(y,{class:"group-hd"},{default:l((()=>[i(y,{class:"left"},{default:l((()=>[i(x,{class:"min-name"},{default:l((()=>[n("最近搜索")])),_:1})])),_:1}),i(y,{class:"right"},{default:l((()=>[i(x,{class:"icon iconfont icon-lajitong",onClick:f.clearStorage},null,8,["onClick"])])),_:1})])),_:1}),i(y,{class:"before-search"},{default:l((()=>[(s(!0),u(h,null,p(g.arr,((t,e)=>(s(),o(x,{class:"item",key:e,onClick:t=>f.search(g.arr[e])},{default:l((()=>[n(r(g.arr[e]),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1},8,["onTouchmove"])):d("",!0)}],["__scopeId","data-v-1a3e8e1c"]])},data:()=>({loading:!0,loadding:!0,phoneHeight:0,scrollviewHigh:0,background:"",listData:[],indicatorDots:!0,autoplay:!0,interval:2e3,duration:500,items:[],is_collection:!1,is_follow:"0",is_homepush:!1,homepush_data:{},target:0,thisindex:0,category_list:[],product_list:[],page:1,last_page:0,no_more:!1,title_name:"",title_type:"text",bgcolor:"",url:"",jweixin:null,toplogo:"",titleTextColor:"",diytop:0,showSearch:!1,openCategory:{color:"#000000",open:0}}),watch:{thisindex:function(t,e){t!=e&&(console.log(t),this.category_id=this.category_list[t].category_id,this.toggleInit(),0!=t&&this.getProduct())}},computed:{loadingType(){return this.loading?1:0!=this.product_list.length&&this.no_more?2:0},scrolltop(){let t=80-2*this.diytop;return t<=0?0:t}},onShow(){this.getTabBarLinks()},onTabItemTap(){window.location.href=this.websiteUrl+this.h5_addr+"/pages/index/index"},onLoad(t){t.invitation_id&&e("invitation_id",t.invitation_id),t.referee_id&&e("referee_id",t.referee_id),this.isWeixin()&&(this.url=window.location.href),this.getData(),this.getList(),this.getTabbar()},onPullDownRefresh(){0==this.thisindex?this.getData():(this.toggleInit(),this.getProduct())},onReachBottom(){this.scrolltolowerFunc(),console.log("到底了")},mounted(){this.init()},methods:{init(){let t=this;T({success(e){t.phoneHeight=e.windowHeight,v().select(".top_head").boundingClientRect((e=>{let a=t.phoneHeight-e.height;t.scrollviewHigh=a})).exec()}})},onRefresh(){},getData(){let t=this;S({title:"加载中"}),t._get("index/index",{url:t.url},(function(e){t.listData=e.data.list,t.background=e.data.background,t.items=e.data.items,t.title_name=e.data.page.params.title,t.bgcolor=e.data.page.style.titleBackgroundColor,t.setPage(e.data.page),t.toplogo=e.data.page.params.toplogo,t.title_type=e.data.page.params.title_type,t.titleTextColor=e.data.page.style.titleTextColor,t.openCategory=e.data.page.category;let a=B("homepush_name");if(e.data.setting.homepush.is_open&&a!=e.data.setting.homepush.name&&(t.homepush_data=e.data.setting.homepush,t.is_homepush=!0,t.is_homepush=!0),""!=t.url){t.jweixin=t.configWxScan(e.data.signPackage);let a={};t.configWx(e.data.share.signPackage,e.data.share.shareParams,a)}H(),t.loadding=!1,I()}))},getList(){let t=this;t._get("product.category/index",{},(function(e){t.category_list=e.data.list;t.category_list.unshift({name:"推荐",category_id:"0"})}))},getProduct(){let t=this,e=t.page;t.loading=!0,t._get("product.product/lists",{page:e||1,category_id:t.category_id,search:"",sortType:"all",sortPrice:0,list_rows:20},(function(e){t.loading=!1,I(),t.product_list=t.product_list.concat(e.data.list.data),t.last_page=e.data.list.last_page,e.data.list.last_page<=1&&(t.no_more=!0)}))},scrolltolowerFunc(){let t=this;t.page<t.last_page&&(t.page++,t.getProduct()),t.no_more=!0},setPage(t){j({title:t.params.name});let e="#000000";"white"==t.style.titleTextColor&&(e="#ffffff"),F({frontColor:e,backgroundColor:"#ffffff"})},toggle(t){let e=t.detail.current;this.target=e,this.category_id=this.category_list[e].category_id,this.toggleInit(),0!=e&&this.getProduct()},toggleInit(){this.page=1,this.last_page=0,this.no_more=!1,this.product_list=[]},scroll(t){this.diytop=t.detail.scrollTop},setIndex(t){this.thisindex=t},onShareAppMessage(){return{title:this.title_name,path:"/pages/index/index?"+this.getShareUrlParams()}},stopTouchMove:()=>!0,scanQrcode:function(){let t=this;t.jweixin.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(e){t.gotoPage("/pages/store/clerkorder?order_no="+e.resultStr)},error:function(t){a({title:"扫码失败，请重试"})}})},closeSearch(){this.showSearch=!1},getTabbar(){let t=this;if(!B("TabBar").is_auto||0==B("TabBar").is_auto){let e=B("theme");if(e){D({color:"#333333",selectedColor:["#ff5704","#19ad57","#ffcc00","#1774ff","#e4e4e4","#c8ba97","#623ceb"][e]}),L({index:0,text:"首页",iconPath:"static/tabbar/home.png",selectedIconPath:"static/tabbar/home_"+e+".png"}),L({index:1,text:"分类",iconPath:"static/tabbar/category.png",selectedIconPath:"static/tabbar/category_"+e+".png"}),L({index:2,text:"购物车",iconPath:"static/tabbar/cart.png",selectedIconPath:"static/tabbar/cart_"+e+".png"}),L({index:3,text:"我的",iconPath:"static/tabbar/user.png",selectedIconPath:"static/tabbar/user_"+e+".png"})}else setTimeout((function(){t.getTabbar()}),3e3)}}}},[["render",function(t,e,a,x,b,k){const C=_,P=m,T=g,v=Q(R("navBar"),M),S=Q(R("diy"),W),B=y("uni-load-more"),H=f,I=y("Homepush"),j=y("searchProduct"),F=y("tabBar");return s(),o(C,{"data-theme":t.theme(),class:c(t.theme()||"")},{default:l((()=>[i(C,{class:"top_head pr",style:w("background-color: "+b.bgcolor+";")},{default:l((()=>[i(C,{class:"state_top"}),i(C,{class:"head_top",style:w("height:"+t.topBarTop()+"px;")},null,8,["style"]),i(C,{class:"d-b-c",style:w(0==t.topBarHeight()?"":"height:"+t.topBarHeight()+"px;")},{default:l((()=>[i(C,{class:"index_log"},{default:l((()=>["text"==b.title_type?(s(),o(P,{key:0,style:w("color:"+b.titleTextColor+";")},{default:l((()=>[n(r(b.title_name),1)])),_:1},8,["style"])):(s(),o(T,{key:1,src:b.toplogo||"/static/logo.png",mode:"heightFix"},null,8,["src"]))])),_:1}),i(C,{class:"d-s-c flex-1"},{default:l((()=>[i(C,{class:"top_search special",style:w("height:"+t.topBarHeight()+" px;color:"+b.bgcolor+";"),onClick:e[0]||(e[0]=t=>b.showSearch=!0)},{default:l((()=>[i(P,{class:"icon iconfont icon-sousuo",style:w("color:"+b.bgcolor+";")},null,8,["style"]),n(" 搜索商品 ")])),_:1},8,["style"]),i(C,{class:"top_search_right d-c-c",onClick:k.scanQrcode},{default:l((()=>[i(P,{class:"icon iconfont icon-saoyisao1"})])),_:1},8,["onClick"])])),_:1}),i(C,{class:"d-e-c p-0-20"})])),_:1},8,["style"]),b.openCategory.open?(s(),o(C,{key:0,class:"nuter"},{default:l((()=>[i(v,{style:{width:"100%"},color:b.openCategory.color,onCurrentIndex:k.setIndex,currentI:b.thisindex,navList:b.category_list},null,8,["color","onCurrentIndex","currentI","navList"])])),_:1})):(s(),o(C,{key:1,style:{height:"20rpx"}}))])),_:1},8,["style"]),i(C,null,{default:l((()=>[0==b.thisindex?(s(),o(C,{key:0},{default:l((()=>[i(S,{style:{position:"relative"},diyItems:b.items},null,8,["diyItems"])])),_:1})):d("",!0),0!=b.thisindex?(s(),o(C,{key:1},{default:l((()=>[i(C,{class:"product-list"},{default:l((()=>[(s(!0),u(h,null,p(b.product_list,((e,a)=>(s(),o(C,{key:a,class:c(["product_item o-h",a%2==1?"product_item_right":""]),onClick:a=>t.gotoPage("/pages/product/detail/detail?product_id="+e.product_id)},{default:l((()=>[i(C,null,{default:l((()=>[i(T,{src:e.product_image,mode:"",style:{width:"345rpx",height:"345rpx"}},null,8,["src"])])),_:2},1024),i(C,{class:"text-ellipsis-2 f26 pro_name p-0-20 mt20"},{default:l((()=>[n(r(e.product_name),1)])),_:2},1024),i(C,{class:"mt36 mb20 p-0-20"},{default:l((()=>[i(P,{class:"f20 fb redF6"},{default:l((()=>[n("￥")])),_:1}),i(P,{class:"f32 fb redF6"},{default:l((()=>[n(r(e.product_sku.product_price),1)])),_:2},1024),i(P,{class:"text-d-line f20 gray9 ml10"},{default:l((()=>[n("￥")])),_:1}),i(P,{class:"text-d-line f24 gray9"},{default:l((()=>[n(r(e.product_sku.line_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),0!=b.product_list.length||b.loading?(s(),o(B,{key:1,loadingType:k.loadingType},null,8,["loadingType"])):(s(),o(C,{key:0,class:"d-c-c p30 ww100"},{default:l((()=>[i(P,{class:"iconfont icon-wushuju"}),i(P,{class:"cont"},{default:l((()=>[n("亲，暂无相关记录哦")])),_:1})])),_:1}))])),_:1})):d("",!0)])),_:1}),b.is_collection?(s(),o(C,{key:0,class:"collection-box",style:w("top:"+(t.topBarTop()+t.topBarHeight()+10)+"px;")},{default:l((()=>[i(C,{class:"inner"},{default:l((()=>[i(P,null,{default:l((()=>[n("点击“")])),_:1}),i(P,{class:"point"},{default:l((()=>[n(".")])),_:1}),i(P,{class:"point point-big"},{default:l((()=>[n(".")])),_:1}),i(P,{class:"point"},{default:l((()=>[n(".")])),_:1}),i(P,null,{default:l((()=>[n("”添加到我的小程序，\\n微信首页下拉即可快速访问店铺")])),_:1})])),_:1}),i(H,{type:"primary",class:"close-btn",onClick:e[1]||(e[1]=t=>b.is_collection=!1)},{default:l((()=>[n("x")])),_:1})])),_:1},8,["style"])):d("",!0),b.is_homepush?(s(),o(I,{key:1,homepush_data:b.homepush_data},null,8,["homepush_data"])):d("",!0),i(j,{isShow:b.showSearch,onClose:k.closeSearch},null,8,["isShow","onClose"]),i(F)])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-0110f9ac"]]);export{q as default};
