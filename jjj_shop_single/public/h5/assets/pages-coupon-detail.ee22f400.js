import{_ as a,D as t,a7 as e,y as l,A as s,a as o,M as i,o as d,c,w as n,e as p,g as u,b as r,n as _,f as g,r as f,F as A,d as y,t as h,u as m,j as k,h as C,i as w,k as b}from"./index-024cd044.js";import{u as F}from"./uni-load-more.46aeda4b.js";const v="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACc0lEQVQ4T22TvU9TURjGn+e0pbf3FisffoRAWwJGZWJw0MGBQSMYFkGDi6NuhhhwY6BaQwIaTYyf/4IrRo0mYhzUOCGJCYa28qFMxsb23lvoPa+5BZrycYYznI9fnvf3nkMAKCXrj3lK9ylgdi5TnDkBrPvrO0cpXtflBUPnlGDOyBbf+Pv0JzsZHYJCCpA8NUeMXOEjAa8WkO8Id4Z0KA3IaYAvzGzhehXgttcf9SBpUs4D+EbhiJGtQLR/yG0Ld+hQMAXBBQDfFWXMyNjTVYAAqtQePqIZukNInwCzoL4RWXA+uQkjLiqQAjAgwHzAw0h4sTjDzTIrJWwNP4mmTADSC/Ar6N2lqH4RDAnxIyAYDWeL72rL2waoCE1Ej3sKE6CcBZgHJAZgXmncDOeKb3e62QUQgGud0S7tyZQQPSLMgHr0S8Z+3QOUd3amApAWmA4jjaWQU2jI4a8PsRNmtwqoa1rrV2bOnvZrlk6EHTfSvA7HiS3jT1ViMWH2UqkxUD7LukxaS/YvX2w+HovFFvP/CJSlFRG3zrwswqskX0YyBV/sxjsotFtnCD4g0QbIM/Fkyvpp/96KK0kYLq2LAqRARkVw38oW0lXA6iFY+yLRfircAnCQIk/LgnvRXHHVj+1qaxDClCaaFOSxrOmH5rKzUgVUPGwcHADoR2vWWh4p5T0p6+CpgEJagAM+WG+Ct9Jt60I2CeMwrUGA4xrYT+IDRbpBNgrlufYw5aeq7cSuNi61ItIctC4JMQ6wFRAXhO9lstbLngmq0lpglozoFREMg3hvl7zbTSvO8l4/dFeCKiSOBpvmSQZlzlxwlva67K/9B2y0FSC6laY7AAAAAElFTkSuQmCC";const D=a({components:{uniLoadMore:F},data:()=>({loading:!0,statusBarHeight:0,titleBarHeight:0,titleHeight:0,opacity:0,coupon_id:0,listData:[],detail:{},apply_range:10,last_page:0,page:1,list_rows:10,no_more:!1}),computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},onPageScroll(a){a.scrollTop<100?this.opacity=a.scrollTop/100:this.opacity=1},onReady(){t({frontColor:"#000000",backgroundColor:"#FFFFFF"})},onLoad(a){this.coupon_id=a.coupon_id,this.apply_range=a.apply_range,this.GetStatusBarHeight()},onShow(){this.page=1,this.listData=[],this.getData()},onReachBottom(){let a=this;20!=a.apply_range&&(a.page<a.last_page&&(a.page++,a.getData()),a.no_more=!0)},methods:{GetStatusBarHeight(){const a=e();this.statusBarHeight=a.statusBarHeight,this.titleHeight=this.statusBarHeight},getData(){let a=this;a.loading=!0,l({title:"加载中"});let t={coupon_id:a.coupon_id};20!=a.apply_range&&(t.page=a.page||1,t.list_rows=a.list_rows),a._get("coupon.coupon/detail",t,(function(t){s(),a.loading=!1,a.detail=t.data.model,20==a.apply_range?a.listData=t.data.model.product:30==a.apply_range&&(a.listData=a.listData.concat(t.data.product_list.data),a.last_page=t.data.product_list.last_page,t.data.product_list.last_page<=1&&(a.no_more=!0))}))},receiveCoupon(){let a=this;if(0==a.detail.state.value)return!1;a._post("user.coupon/receive",{coupon_id:a.detail.coupon_id},(function(t){o({title:"领取成功",icon:"success",mask:!0,duration:2e3}),a.detail.state.value=0,a.detail.state.text="已领取"}))},goback(){i()}}},[["render",function(a,t,e,l,s,o){const i=k,F=u,D=C,B=w,x=b("uni-load-more");return s.loading?p("",!0):(d(),c(F,{key:0,class:"coupon_bg"},{default:n((()=>[r(F,{class:"coupon-detail-top"},{default:n((()=>[r(F,{class:"top_box"},{default:n((()=>[r(F,{class:"item-wrap"},{default:n((()=>[r(F,{class:_("coupon-item coupon-item-"+s.detail.color.text)},{default:n((()=>[r(F,{class:"circles"},{default:n((()=>[(d(),g(A,null,f(8,((a,t)=>r(i,{key:t}))),64))])),_:1}),r(F,{class:"info"},{default:n((()=>[r(F,null,{default:n((()=>[y(h(s.detail.coupon_type.text),1)])),_:1})])),_:1}),r(F,{class:"operation d-b-c w-b"},{default:n((()=>[r(F,{class:"flex-1 coupon-content"},{default:n((()=>[r(F,null,{default:n((()=>[10==s.detail.coupon_type.value?(d(),c(F,{key:0,class:"price"},{default:n((()=>[r(i,{class:"f40 fb"},{default:n((()=>[y("减"+h(1*s.detail.reduce_price)+"元",1)])),_:1})])),_:1})):p("",!0),20==s.detail.coupon_type.value?(d(),g(A,{key:1},[r(i,{class:"f40 fb"},{default:n((()=>[y(h(s.detail.discount),1)])),_:1}),r(i,null,{default:n((()=>[y("折")])),_:1})],64)):p("",!0)])),_:1}),r(F,{class:"f30"},{default:n((()=>[y(h(s.detail.min_price>0?"满"+1*s.detail.min_price+"元可用":"无门槛"),1)])),_:1}),r(F,{class:"f24"},{default:n((()=>[20==s.detail.expire_type?(d(),g(A,{key:0},[y(" 有效期："+h(s.detail.start_time.text)+" 至 "+h(s.detail.end_time.text),1)],64)):p("",!0),10==s.detail.expire_type?(d(),g(A,{key:1},[y(" 有效期：领取后"+h(s.detail.expire_day)+"天有效 ",1)],64)):p("",!0)])),_:1})])),_:1}),r(F,{class:"btns d-c-c",onClick:t[1]||(t[1]=a=>o.receiveCoupon())},{default:n((()=>[1==s.detail.state.value?(d(),c(D,{key:0,type:"default",class:_("btn-red")},{default:n((()=>[y(" 立即领取 ")])),_:1})):(d(),c(D,{key:1,type:"default",class:"btn-gray",onClick:t[0]||(t[0]=m((()=>{}),["stop"]))},{default:n((()=>[y(h(s.detail.state.text),1)])),_:1}))])),_:1})])),_:1})])),_:1},8,["class"])])),_:1})])),_:1}),10!=s.apply_range?(d(),c(F,{key:0,class:"redF6 f26 fb pt30 d-c-c"},{default:n((()=>[r(B,{class:"decorate",src:v,mode:"aspectFill"}),r(i,{class:"ml10 mr10"},{default:n((()=>[y("指定以下商品使用")])),_:1}),r(B,{class:"decorate",src:v,mode:"aspectFill"})])),_:1})):p("",!0),10!=s.apply_range?(d(),c(F,{key:1,class:"o-h pro_list"},{default:n((()=>[r(F,{class:"d-b-c f-w"},{default:n((()=>[(d(!0),g(A,null,f(s.listData,((t,e)=>(d(),c(F,{class:"pro_item",key:e,onClick:e=>a.gotoPage("/pages/product/detail/detail?product_id="+t.product_id)},{default:n((()=>[r(F,{class:"pro_item_image"},{default:n((()=>[r(B,{src:t.product_image||"/static/default.png",mode:"aspectFill"},null,8,["src"])])),_:2},1024),r(F,{class:"f26 gray3 text-ellipsis mt20 mb23 tc"},{default:n((()=>[y(h(t.product_name),1)])),_:2},1024),r(F,{class:"fb redF6 tc"},{default:n((()=>[r(i,{class:"f22"},{default:n((()=>[y("￥")])),_:1}),r(i,{class:"f32"},{default:n((()=>[y(h(t.product_price),1)])),_:2},1024)])),_:2},1024),r(F,{class:"d-c-c"},{default:n((()=>[r(D,{class:"add_btn"},{default:n((()=>[y("加入购物车")])),_:1})])),_:1})])),_:2},1032,["onClick"])))),128))])),_:1}),0!=s.listData.length||s.loading?(d(),c(x,{key:1,loadingType:o.loadingType},null,8,["loadingType"])):(d(),c(F,{key:0,class:"d-c-c p30 ww100"},{default:n((()=>[r(i,{class:"iconfont icon-wushuju"}),r(i,{class:"cont"},{default:n((()=>[y("亲，暂无相关记录哦")])),_:1})])),_:1}))])),_:1})):p("",!0)])),_:1})])),_:1}))}],["__scopeId","data-v-6a367ba7"]]);export{D as default};
